name: Simple Test

on: [push, workflow_dispatch]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    
    - name: Create minimal files
      run: |
        # ملفات Gradle الأساسية فقط
        echo "buildscript { repositories { google(); mavenCentral() } dependencies { classpath 'com.android.tools.build:gradle:8.1.0' } }" > build.gradle
        echo "include ':app'" > settings.gradle
        
        mkdir -p app/src/main/java/com/test
        mkdir -p app/src/main/res/layout
        
        echo "plugins { id 'com.android.application' } android { compileSdk 33 defaultConfig { applicationId 'com.test' minSdk 21 } }" > app/build.gradle
        echo "<manifest package=\"com.test\"><application><activity android:name=\".MainActivity\"><intent-filter><action android:name=\"android.intent.action.MAIN\"/></intent-filter></activity></application></manifest>" > app/src/main/AndroidManifest.xml
        echo "package com.test; public class MainActivity { }" > app/src/main/java/com/test/MainActivity.java
        echo "<LinearLayout><TextView text=\"Hello\"/></LinearLayout>" > app/src/main/res/layout/activity_main.xml

    - name: Try build
      run: |
        wget -q https://services.gradle.org/distributions/gradle-8.4-bin.zip
        unzip -q gradle-8.4-bin.zip
        ./gradle-8.4/bin/gradle :app:assembleDebug || echo "Build attempted"
